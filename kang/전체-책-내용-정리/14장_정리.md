# 14장 - 마무리

---

> 이번 장에서 다루는 내용
>
> - 이 책의 여정 돌아보기
> - 기본 원리 탐구
> - 여정을 계속할 방법에 대한 제안

---

## 14.1 - 이 책의 여정을 돌아보며

### 14.1.1 - 소개: 동기

- 처음 두 장에서는 리팩터링이 무엇이고, 왜 필수적인지, 언제 우선시해야 하는지 살펴보았다.
- 리팩터링의 목표를 정의하기 위한 기반을 마련했다.
- 불변속성을 지역화해서 취약성과 결함을 줄이고 유연성을 높이면서 소프트웨어 도메인을 이해

### 14.1.2 - 1부: 구체화하기

- 1부에서 사용한 코드베이스를 기반으로 단계별로 개선했다.
- `긴 함수 분해하기`, `타입 코드를 클래스로 대체하기`, `함수를 클래스로 넣어 메서드 만들기`, \
  `코드베이스를 확장한 후 if 문, 함수 및 클래스로 통합하기`, `캡슐화`

### 14.1.3 - 2부: 지평 넓히기

- 리팩터링과 코드 품질에 영향을 미치는 사회-기술적 주제를 살펴봤다.
- 문화, 스킬 및 도구와 관련된 주제를 논의했다.
- `컴파일러`, `기능 토글`, `칸반`, `제약 이론 및 기타 여러 도구`, \
  `코드 삭제`, `추가 및 훼손에 대한 접근방식`과 같은 문화적 변화를 다뤘고, 마지막으로 `최적화`에 대해 다뤘다.

---

## 14.2 - 기본 철학 탐구

### 14.2.1 - 항상 더 작은 단계 찾기

- 이 책은 더 작은 단계를 수행하면 오류 위험이 줄어드는 `TDD` 및 기타 방법과 근본적인 생각을 공유한다.
- 큰 문제를 작은 조각으로 분해하는 능력은 프로그래밍의 중요한 부분이다.
- 작은 단계를 통해 개선하려는 것이 리팩터링의 전부이다.
- 리팩터링 할 땐 **그린에서 그린으로**(green to green: 안전한 상태에서 다시 안전한 상태로)의 방식을 따른다.
    - 리팩터링 과정에서 최소한의 작업만 소실하기 위해 → 롤백을 쉽게 하기 위해

### 14.2.2 - 기본 구조 찾기

- 빈 줄을 사용해서 메서드가 있어야 할 위치 찾기, 메서드를 사용해서 클래스가 있어야 할 위치 찾기
- 즉, 내부에서 시작해서 더 추상적인 레이어로 점진적으로 변경 사항을 적용해야 한다.

### 14.2.3 - 협업을 위한 규칙 사용

- 이 책에 나온 리팩터링 규칙이 팀원을 평하가는 도구로 사용하면 안 된다. (절대적인 것은 없다)
- 코드 품질에 대한 의견을 나누기 위한 출발점으로 활용하면 좋다.

### 14.2.4 - 개인보다 팀을 우선시하기

- 소프트웨어 개발은 팀의 노력이다. 데브옵스 애자일 모두 긴밀한 협업에 집중해야 한다.
    - 구글의 신입 사원은 전체 코드, 회사 일정을 모두 볼 수 있다. ([구글 조직문화](https://www.midashri.com/blog/google-workrules), 2번 내용)

### 14.2.5 - 완전성보다 단순성 우선하기

- 중요한 설계 원칙을 준수해야 한다.
- 좋지 않는 코드를 보고 이를 허용하지 않는 규칙을 만들고자 할때 보편성을 추구하는 함정에 빠지기 쉽다.
- 인지 심리학에서 `빠르지만 정확하지 않는다`, `느리고 에너지 비용이 많이 들지만 정확하다` 두 가지 인지 작업 시스템을 설명한다(각각 1, 2). \
  프로그래밍은 주로 문제 해결에 관한 것이라 시스템 2의 작업이다. \
  따라서, **사람들이** **실행하기 바라는 모든 규칙은 생각 없이 적용할 수 있을 정도로 간단**해야 한다.
- ‘**단순하지만 잘못된**’, ‘**복잡하지만 옳은**’ 사이의 행위 변화를 바란다면 **‘단순하지만 잘못된’을 선택**해야 한다?
    - 지나친 단순화는 안 된다. (상식을 통해 막을 수 있음)

### 14.2.6 - 객체 또는 고차함수 사용하기

- 고차함수, 람다, 델리게이트, 클로저, 화살표 함수, 등 팀에서 더 읽기 쉽다고 생각하는 스타일로 작성해라.

---

## 14.3 - 이후 여정

- 리팩터링 후 **매크로 아키텍처**, **마이크로 아키텍처**, **소프트웨어 품질**로의 여정을 시작하면 된다.

### 14.3.1 - 마이크로 아키텍처를 향한 여정

- 마이크로 또는 팀 내 아키텍처 (이 책의 주요 초점)
- 이 분야는 표현식에서 공개 인터페이스 및 API 설계에 이르기까지 결합도와 취약성에 관한 것이다.

### 14.3.2 - 매크로 아키텍처를 향한 여정

- 매크로 또는 팀 간의 아키텍처
- 콘웨이 법칙과 같은 아키텍처가 조직의 의사소통 구조를 반영한다고 정의하고 매크로 아키텍처를 주도
- 저자는 매크로 아키텍처를 ‘**사람의 길**’이라는 애칭으로 부른다. (코드에 영향을 미치려면 사람에 집중해라)

### 14.3.3 - 소프트웨어 품질을 향한 여정

- 소프트웨어 품질을 연구
- 저자는 **코딩 능력이 없다면 테스트**를 배우라고 권한다고 한다.
    - 추천 책 : <테스트 주도 개발, 인사이트, 2014, 켄트 백>
- **플랫폼 팀은** 확장 가능한 도구의 형태로 소프트웨어를 제공하므로 **타입 이론**을 배우라고 권한다.
    - 확장 가능한 도구의 형태 : 라이브러리, 프레임워크, …, 등
    - 추천 책 : <Types and Programming Language, MIT Prees, 2002, 벤자민 C. 피어스>
- **야심이 큰 독자의 경우 종속 타입이나 증명 보조기를 통해 증명 가능한 정확성을 연구**해볼 수 있다.
    - 추천 책 : <Type-Driven Development with Idris, Manning, 2017, 에드윈 브래디> (함수형 기반)

---

## 요약

- 리팩터링의 중요성을 강조 및 예제를 가지고 구체적인 규칙과 패턴을 살펴봤다. (1부)
- 시야를 넓히고 코드 품질에 영향을 미치는 사회-기술적 주제에 관해 논의했다. (2부)
- 이 책의 기본 철학은 안정적인 상태에서 안정적인 상태로 이동하는 작은 단계로 분해하는 데 기반을 둔다.
- 구조가 숨겨져 있는 경우가 많다는 것을 인식하고, 빈 줄을 통해 메서드가 있어야 할 위치 안내하고, 메서드를 통해 클래스가 있어야 할 위치를 찾자.
- 규칙은 협업과 팀워르를 지원하는 데 사용해야 한다. 또한, 리팩터링을 할 때 상식을 대체할 순 없다.
- 이 책의 규칙과 조언은 환경과 상황을 고려해서 사람을 염두에 두고 설계했다. 행위를 바꾸고 싶다면 정확함보다 단순함을 선택해야 한다.